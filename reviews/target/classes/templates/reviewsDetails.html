<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" xmlns:sec="http://www.w3.org/1999/xhtml" lang="en">
<head th:replace="layout :: head"></head>

<body>
<nav th:replace="layout :: nav"></nav>
<div th:replace="layout :: flash"></div>
<link rel="stylesheet" th:href="@{/assets/css/commentSection.css}"/>


<div class="container mt-5 mb-5">
    <div class="d-flex justify-content-center row">
        <div class="col-md-10">

            <form class="needs-validation" novalidate th:object="${reviewRequest}"
                  th:action="'/reviews/' + ${product.id}" method="post">
                <div class="d-flex flex-row align-items-center add-comment p-2 bg-white rounded">
                    <img class="rounded-circle"
                         src="https://shooterstv.live/wp-content/uploads/2020/10/ti-default.png"
                         width="40">
                    <input type="hidden" id="rating" name="rating" value="2">
                    <input type="hidden" id="product" name="product" th:value="${product.id}">

                    <input
                            type="text" class="form-control border-0 no-box-shadow ml-1"
                            placeholder="Leave your review here..." name="comment">

                </div>
                <div class="d-flex flex-row align-items-center add-comment p-2 bg-white rounded">

                    <div class="main" style="width:100%;">
                        <i class="bi bi-star-fill" id="one"></i>
                        <i class="bi bi-star-fill" id="two"></i>
                        <i class="bi bi-star" id="three"></i>
                        <i class="bi bi-star" id="four"></i>
                        <i class="bi bi-star" id="five"></i>
                    </div>
                    <button type="submit" class="btn btn-primary">Submit</button>
                </div>
            </form>
        </div>
        <div class="col-md-10 centered">
            <button class="btn btn-primary" data-toggle="modal"
                    data-target="#modalReview">Add a review
            </button>
        </div>
    </div>

    <h3>Reviews for product with ID:</h3>
    <h3 th:text="${product}"></h3>

    <div th:each="review, stat : ${reviews}" th:id="${review.id}" class="p-3 bg-light mt-2 rounded">
        <div class="d-flex justify-content-between">
            <div class="d-flex flex-row user">
                <img class="rounded-circle img-fluid img-responsive"
                     src="https://shooterstv.live/wp-content/uploads/2020/10/ti-default.png" width="40">
                <div class="d-flex flex-column ml-2">
                    <span class="font-weight-bold" th:text="${review.author}"></span>
                    <span class="day" th:text="${review.dateAdded}"></span>
                </div>
            </div>
            <div class="card-text main">
                <i class="bi bi-star star1"></i>
                <i class="bi bi-star star2"></i>
                <i class="bi bi-star star3"></i>
                <i class="bi bi-star star4"></i>
                <i class="bi bi-star star5"></i>
            </div>
            <div class="d-flex align-items-center px-3">

                <input type="hidden" id="reviewId" th:value="${review.id}">
                <input type="hidden" class="ratings" name="ratingReview" th:value="${review.rating}">

                <form sec:authorize="isAuthenticated()" th:action="'/reviews/delete/' + ${review.id}" method="post">
                    <button type="submit" class="btn btn-dark"><i class="bi bi-trash"></i></button>
                </form>
            </div>
        </div>
        <div class="comment-text text-justify mt-2">
            <p th:text="${review.comment}"></p>
        </div>
    </div>

</div>


<div th:replace="layout :: scripts"></div>

<script type="text/javascript" th:src="@{/assets/js/reviews.js}"></script>

<script type="text/javascript" th:src="@{/assets/js/newReview.js}"></script>

</body>
</html>